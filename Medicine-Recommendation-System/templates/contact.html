<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Health Care Center - Chatbot Feedback</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c6c8c;
            --secondary-color: #4ca1af;
            --accent-color: #56ba91;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --success-color: #198754;
            --info-color: #0dcaf0;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf9 100%);
            font-family: 'Roboto', sans-serif;
            transition: background 0.5s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .dark-mode {
            background: linear-gradient(135deg, #2c3e50 0%, #1a2530 100%);
            color: #e4edf9;
        }
        .dark-mode .container-custom {
            background: #343a40;
            color: #e4edf9;
        }
        .dark-mode .form-control, .dark-mode .form-select {
            background-color: #495057;
            color: #e4edf9;
            border-color: #6c757d;
        }
        .dark-mode .modal-content {
            background-color: #343a40;
            color: #e4edf9;
        }
        .dark-mode .chat-container {
            background-color: #343a40;
        }
        .dark-mode .chat-message.user {
            background-color: #495057;
        }
        .dark-mode .chat-message.bot {
            background-color: #2c6c8c;
        }
        .dark-mode .medicine-reminder {
            background-color: #343a40;
            border-color: #495057;
        }
        .navbar {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .logo img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease;
        }
        .logo img:hover {
            transform: rotate(10deg) scale(1.1);
        }
        .container-custom {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            margin-bottom: 40px;
        }
        .container-custom:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        .btn-custom {
            border-radius: 30px;
            padding: 10px 25px;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .btn-custom:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.4s ease-in-out;
            z-index: -1;
        }
        .btn-custom:hover:before {
            left: 0;
        }
        .btn-custom:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.2);
        }
        .mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--dark-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .mode-toggle:hover {
            transform: rotate(30deg);
        }
        .floating-help {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .floating-help:hover {
            transform: scale(1.1);
        }
        .navbar-nav .nav-link {
            position: relative;
            margin: 0 10px;
        }
        .navbar-nav .nav-link:after {
            content: "";
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: white;
            transition: width 0.3s ease;
        }
        .navbar-nav .nav-link:hover:after {
            width: 100%;
        }
        .form-control, .form-select {
            border-radius: 10px;
            padding: 12px 15px;
            box-shadow: none;
            transition: all 0.3s ease;
        }
        .form-control:focus, .form-select:focus {
            box-shadow: 0 0 0 3px rgba(44, 108, 140, 0.25);
            border-color: var(--primary-color);
        }
        /* Chat container styles */
        .chat-container {
            height: 400px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin-bottom: 20px;
        }
        .chat-message {
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            max-width: 80%;
            position: relative;
            word-wrap: break-word;
        }
        .chat-message.user {
            background-color: #e9ecef;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        .chat-message.bot {
            background-color: var(--primary-color);
            color: white;
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }
        .chat-message .time {
            font-size: 0.75rem;
            position: absolute;
            bottom: -18px;
            opacity: 0.7;
        }
        .chat-message.user .time {
            right: 10px;
        }
        .chat-message.bot .time {
            left: 10px;
        }
        .chat-input-container {
            display: flex;
            gap: 10px;
        }
        .chat-input {
            flex-grow: 1;
            border-radius: 20px;
            padding-right: 50px;
        }
        .send-button {
            border-radius: 50%;
            width: 45px;
            height: 45px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Rating styles */
        .rating-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        .rating-star {
            font-size: 30px;
            color: #ccc;
            cursor: pointer;
            margin: 0 5px;
            transition: color 0.2s ease;
        }
        .rating-star:hover, .rating-star.active {
            color: #ffc107;
        }
        /* Medicine reminder styles */
        .medicine-reminder {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid var(--primary-color);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .medicine-reminder:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }
        .reminder-delete, .reminder-complete {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
        }
        .reminder-delete {
            color: var(--danger-color);
        }
        .reminder-delete:hover {
            color: #b52d3a;
        }
        .reminder-complete {
            color: var(--success-color);
        }
        .reminder-complete:hover {
            color: #146c43;
        }
        .completed {
            text-decoration: line-through;
            opacity: 0.7;
            background-color: #f8f9fa;
            border-left-color: var(--success-color);
        }
        .reminder-time {
            font-weight: bold;
            color: var(--primary-color);
        }
        .reminder-details {
            flex: 1;
            margin: 0 15px;
        }
        .reminder-actions {
            display: flex;
            gap: 10px;
        }
        .pulse-animation {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(220, 53, 69, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
            }
        }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <div class="logo">
                <img src="https://via.placeholder.com/50" alt="Health Center Logo">
            </div>
            <a class="navbar-brand" href="#">Health Center</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-home me-1"></i> Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#"><i class="fas fa-robot me-1"></i> Chatbot</a></li>
                    <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-pills me-1"></i> Reminders</a></li>
                    <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-info-circle me-1"></i> About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#"><i class="fas fa-envelope me-1"></i> Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5">
        <h1 class="text-center mb-4"><span class="text-primary">Health</span> <span class="text-success">Assistant</span> <span class="text-danger">Chatbot</span></h1>
        <p class="text-center text-muted mb-5">Ask questions, get health advice, and manage your medicine reminders</p>
        <div class="row">
            <div class="col-lg-8">
                <div class="container-custom">
                    <h3 class="mb-4"><i class="fas fa-comments me-2 text-primary"></i>Chat with Health Assistant</h3>
                    <div class="chat-container" id="chatContainer">
                        <div class="chat-message bot">
                            <div class="message-content">Hello! I'm your Health Assistant. How can I help you today? You can ask me about symptoms, medicine reminders, or health advice.</div>
                            <span class="time">Just now</span>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="form-control chat-input" id="chatInput" placeholder="Type your message here...">
                        <button class="btn btn-primary send-button" id="sendButton">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="mt-4">
                        <h5 class="mb-3">How would you rate your chat experience?</h5>
                        <div class="rating-container">
                            <i class="fas fa-star rating-star" data-rating="1"></i>
                            <i class="fas fa-star rating-star" data-rating="2"></i>
                            <i class="fas fa-star rating-star" data-rating="3"></i>
                            <i class="fas fa-star rating-star" data-rating="4"></i>
                            <i class="fas fa-star rating-star" data-rating="5"></i>
                        </div>
                        <div class="mt-3">
                            <textarea class="form-control" id="feedbackText" rows="3" placeholder="Please share your feedback to help us improve..."></textarea>
                        </div>
                        <button class="btn btn-success btn-custom mt-3" id="submitFeedback">
                            <i class="fas fa-check-circle me-2"></i> Submit Feedback
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="container-custom">
                    <h3 class="mb-4"><i class="fas fa-pills me-2 text-danger"></i>Medicine Reminders</h3>
                    <div id="remindersList">
                        <!-- Dynamic reminders will be inserted here -->
                    </div>
                    <form id="addReminderForm">
                        <div class="mb-3">
                            <label for="medicineName" class="form-label">Medicine Name</label>
                            <input type="text" class="form-control" id="medicineName" required>
                        </div>
                        <div class="mb-3">
                            <label for="dosage" class="form-label">Dosage</label>
                            <input type="text" class="form-control" id="dosage" placeholder="e.g., 1 pill" required>
                        </div>
                        <div class="mb-3">
                            <label for="timeToTake" class="form-label">Time to Take</label>
                            <input type="time" class="form-control" id="timeToTake" required>
                        </div>
                        <div class="mb-3">
                            <label for="frequency" class="form-label">Frequency</label>
                            <select class="form-select" id="frequency" required>
                                <option value="daily">Daily</option>
                                <option value="twice">Twice Daily</option>
                                <option value="three">Three Times Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        <div class="mb-3 d-none" id="customFrequencyContainer">
                            <label for="customFrequency" class="form-label">Custom Frequency</label>
                            <input type="text" class="form-control" id="customFrequency" placeholder="e.g., Every 2 days">
                        </div>
                        <div class="mb-3">
                            <label for="notes" class="form-label">Notes</label>
                            <textarea class="form-control" id="notes" rows="2" placeholder="Additional instructions or notes"></textarea>
                        </div>
                        <button type="submit" class="btn btn-danger btn-custom w-100 pulse-animation">
                            <i class="fas fa-plus-circle me-2"></i> Add Reminder
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal fade" id="helpModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-question-circle me-2"></i> Help & Instructions
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="fas fa-robot fa-3x text-primary"></i>
                    </div>
                    <h4 class="text-center mb-3">How to Use the Health Assistant</h4>
                    <div class="mb-4">
                        <h5><i class="fas fa-comments me-2"></i> Using the Chatbot</h5>
                        <p>Type your health-related questions in the chat input field and press send or hit Enter.</p>
                        <p>The chatbot can help with general health questions, symptom information, and wellness advice.</p>
                    </div>
                    <div class="mb-4">
                        <h5><i class="fas fa-pills me-2"></i> Medicine Reminders</h5>
                        <p>Add medicine reminders by filling out the form on the right.</p>
                        <p>Receive notifications when it's time to take your medication.</p>
                        <p>Mark reminders as complete or delete them when no longer needed.</p>
                    </div>
                    <div class="mb-4">
                        <h5><i class="fas fa-star me-2"></i> Feedback</h5>
                        <p>Rate your experience with the chatbot using the star rating system.</p>
                        <p>Share your thoughts or suggestions in the feedback text area.</p>
                    </div>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i> Important: This tool provides general information only and is not a substitute for professional medical advice, diagnosis, or treatment.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mode toggle button -->
    <div class="mode-toggle" id="modeToggle">
        <i class="fas fa-moon"></i>
        <span class="sr-only">Toggle dark mode</span>
    </div>

    <!-- Floating help button -->
    <div class="floating-help" data-bs-toggle="modal" data-bs-target="#helpModal">
        <i class="fas fa-question"></i>
        <span class="sr-only">Help</span>
    </div>

    <!-- Footer -->
    <footer class="py-4 text-center text-white mt-auto" style="background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));">
        <div class="container">
            <p class="mb-0">&copy; 2025 Health Care Center. All rights reserved.</p>
            <p class="mb-0 mt-2">
                <a href="#" class="text-white text-decoration-none me-3">Privacy Policy</a>
                <a href="#" class="text-white text-decoration-none me-3">Terms of Service</a>
                <a href="#" class="text-white text-decoration-none">FAQ</a>
            </p>
            <div class="mt-3">
                <a href="#" class="text-white mx-2"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-white mx-2"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-white mx-2"><i class="fab fa-instagram"></i></a>
                <a href="#" class="text-white mx-2"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>

    <!-- JavaScript Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const chatContainer = document.getElementById('chatContainer');
            const chatInput = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendButton');
            const ratingStars = document.querySelectorAll('.rating-star');
            const feedbackText = document.getElementById('feedbackText');
            const submitFeedback = document.getElementById('submitFeedback');
            const modeToggle = document.getElementById('modeToggle');
            const addReminderForm = document.getElementById('addReminderForm');
            const remindersList = document.getElementById('remindersList');
            const frequencySelect = document.getElementById('frequency');
            const customFrequencyContainer = document.getElementById('customFrequencyContainer');

            // ChatBot functionality
            function getSimulatedResponse(userMessage) {
                const userInput = userMessage.toLowerCase();
                if (userInput.includes('hello') || userInput.includes('hi')) {
                    return "Hello! I'm your Health Assistant. How can I help you with your health questions today?";
                } else if (userInput.includes('headache')) {
                    return "Headaches can be caused by many factors including stress, dehydration, lack of sleep, or eye strain. For occasional headaches, rest, hydration, and over-the-counter pain relievers might help. If headaches are severe or persistent, please consult a healthcare provider.";
                } else if (userInput.includes('cold') || userInput.includes('flu')) {
                    return "Cold and flu symptoms include fever, cough, sore throat, and body aches. Rest, fluids, and over-the-counter medications can help manage symptoms. If symptoms are severe or persistent, please consult a healthcare provider.";
                } else if (userInput.includes('diet') || userInput.includes('nutrition')) {
                    return "A balanced diet typically includes fruits, vegetables, whole grains, lean proteins, and healthy fats. It's important to stay hydrated and limit processed foods, excessive sugar, and salt. Consider consulting with a dietitian for personalized advice.";
                } else if (userInput.includes('medicine') || userInput.includes('reminder')) {
                    return "You can set up medicine reminders using the form on the right side of this page. I can help you remember when to take your medications!";
                } else if (userInput.includes('sleep')) {
                    return "Healthy adults need 7-9 hours of sleep per night. Good sleep hygiene includes maintaining a regular sleep schedule, creating a relaxing bedtime routine, and ensuring your sleep environment is comfortable and free from distractions.";
                } else {
                    return "I'm here to provide general health information. If you have specific health concerns, please consult with a healthcare professional. How else can I help you today?";
                }
            }

            async function sendMessageToGPT(userMessage) {
                try {
                    // Simulated response for demonstration purposes
                    return {
                        choices: [{
                            message: {
                                content: getSimulatedResponse(userMessage)
                            }
                        }]
                    };
                } catch (error) {
                    console.error('Error communicating with ChatGPT API:', error);
                    return {
                        choices: [{
                            message: {
                                content: "I'm sorry, I'm having trouble connecting to my services right now. Please try again later."
                            }
                        }]
                    };
                }
            }

            // Add a message to the chat container
            function addMessageToChat(message, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('chat-message', sender);
                const messageContent = document.createElement('div');
                messageContent.classList.add('message-content');
                messageContent.textContent = message;
                const timeElement = document.createElement('span');
                timeElement.classList.add('time');
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                timeElement.textContent = `${hours}:${minutes}`;
                messageElement.appendChild(messageContent);
                messageElement.appendChild(timeElement);
                chatContainer.appendChild(messageElement);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Send user message
            async function sendMessage() {
                const userMessage = chatInput.value.trim();
                if (!userMessage) return;

                // Add user message to chat
                addMessageToChat(userMessage, 'user');
                chatInput.value = '';

                // Show typing indicator
                const typingIndicator = document.createElement('div');
                typingIndicator.classList.add('chat-message', 'bot', 'typing-indicator');
                typingIndicator.innerHTML = '<div class="message-content">Typing<span>.</span><span>.</span><span>.</span></div>';
                chatContainer.appendChild(typingIndicator);
                chatContainer.scrollTop = chatContainer.scrollHeight;

                // Get response from GPT
                const response = await sendMessageToGPT(userMessage);

                // Remove typing indicator
                chatContainer.removeChild(typingIndicator);

                // Add bot response to chat
                const botMessage = response.choices[0].message.content;
                addMessageToChat(botMessage, 'bot');
            }

            // Rating functionality
            function setRating() {
                const rating = this.getAttribute('data-rating');
                ratingStars.forEach(star => {
                    if (star.getAttribute('data-rating') <= rating) {
                        star.classList.add('active');
                    } else {
                        star.classList.remove('active');
                    }
                });
            }

            // Submit feedback
            function handleFeedbackSubmission() {
                const rating = document.querySelectorAll('.rating-star.active').length;
                const feedback = feedbackText.value.trim();
                if (rating === 0) {
                    alert('Please provide a rating before submitting feedback.');
                    return;
                }
                // In a real application, this would send the data to a server
                console.log('Feedback submitted:', {
                    rating: rating,
                    feedback: feedback
                });
                // Show success message
                alert('Thank you for your feedback!');
                // Reset form
                ratingStars.forEach(star => star.classList.remove('active'));
                feedbackText.value = '';
            }

            // Dark mode toggle
            function toggleDarkMode() {
                document.body.classList.toggle('dark-mode');
                const icon = modeToggle.querySelector('i');
                if (document.body.classList.contains('dark-mode')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                }
                // Save preference to localStorage
                const isDarkMode = document.body.classList.contains('dark-mode');
                localStorage.setItem('darkMode', isDarkMode);
            }

            // Medicine reminders functionality
            function addReminder(event) {
                event.preventDefault();
                const medicineName = document.getElementById('medicineName').value.trim();
                const dosage = document.getElementById('dosage').value.trim();
                const timeToTake = document.getElementById('timeToTake').value;
                const frequency = document.getElementById('frequency').value;
                const notes = document.getElementById('notes').value.trim();
                let frequencyText = '';
                if (frequency === 'custom') {
                    frequencyText = document.getElementById('customFrequency').value.trim();
                } else {
                    frequencyText = {
                        'daily': 'Daily',
                        'twice': 'Twice Daily',
                        'three': 'Three Times Daily',
                        'weekly': 'Weekly'
                    }[frequency];
                }

                // Create reminder element
                const reminderElement = document.createElement('div');
                reminderElement.classList.add('medicine-reminder');
                reminderElement.id = `reminder-${Date.now()}`;

                // Format time for display
                const timeObj = new Date(`2025-01-01T${timeToTake}`);
                const formattedTime = timeObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                reminderElement.innerHTML = `
                    <div class="reminder-details">
                        <h5>${medicineName}</h5>
                        <div><strong>Dosage:</strong> ${dosage}</div>
                        <div><strong>Frequency:</strong> ${frequencyText}</div>
                        <div><span class="reminder-time">${formattedTime}</span></div>
                        ${notes ? `<div class="mt-2"><em>${notes}</em></div>` : ''}
                    </div>
                    <div class="reminder-actions">
                        <button class="reminder-complete" title="Mark as taken">
                            <i class="fas fa-check-circle"></i>
                        </button>
                        <button class="reminder-delete" title="Delete reminder">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                `;

                // Add to reminders list
                remindersList.appendChild(reminderElement);

                // Add click handlers for the new reminder
                const completeButton = reminderElement.querySelector('.reminder-complete');
                completeButton.addEventListener('click', function() {
                    reminderElement.classList.toggle('completed');
                    saveReminders();
                });

                const deleteButton = reminderElement.querySelector('.reminder-delete');
                deleteButton.addEventListener('click', function() {
                    if (confirm('Are you sure you want to delete this reminder?')) {
                        remindersList.removeChild(reminderElement);
                        saveReminders();
                    }
                });

                // Reset form
                addReminderForm.reset();
                customFrequencyContainer.classList.add('d-none');

                // Save reminders to localStorage
                saveReminders();
            }

            // Save reminders to localStorage
            function saveReminders() {
                const reminders = [];
                document.querySelectorAll('.medicine-reminder').forEach(element => {
                    const nameElement = element.querySelector('h5');
                    const detailsElements = element.querySelectorAll('.reminder-details div');
                    reminders.push({
                        id: element.id,
                        name: nameElement.textContent,
                        dosage: detailsElements[0].textContent.replace('Dosage:', '').trim(),
                        frequency: detailsElements[1].textContent.replace('Frequency:', '').trim(),
                        time: element.querySelector('.reminder-time').textContent,
                        notes: element.querySelector('.mt-2') ? element.querySelector('.mt-2').textContent : '',
                        completed: element.classList.contains('completed')
                    });
                });
                localStorage.setItem('medicineReminders', JSON.stringify(reminders));
            }

            // Load reminders from localStorage
            function loadReminders() {
                const savedReminders = localStorage.getItem('medicineReminders');
                if (savedReminders) {
                    const reminders = JSON.parse(savedReminders);
                    reminders.forEach(reminder => {
                        const reminderElement = document.createElement('div');
                        reminderElement.classList.add('medicine-reminder');
                        if (reminder.completed) {
                            reminderElement.classList.add('completed');
                        }
                        reminderElement.id = reminder.id;
                        reminderElement.innerHTML = `
                            <div class="reminder-details">
                                <h5>${reminder.name}</h5>
                                <div><strong>Dosage:</strong> ${reminder.dosage}</div>
                                <div><strong>Frequency:</strong> ${reminder.frequency}</div>
                                <div><span class="reminder-time">${reminder.time}</span></div>
                                ${reminder.notes ? `<div class="mt-2"><em>${reminder.notes}</em></div>` : ''}
                            </div>
                            <div class="reminder-actions">
                                <button class="reminder-complete" title="Mark as taken">
                                    <i class="fas fa-check-circle"></i>
                                </button>
                                <button class="reminder-delete" title="Delete reminder">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        `;
                        remindersList.appendChild(reminderElement);
                    });

                    // Add event listeners to loaded reminders
                    document.querySelectorAll('.reminder-complete').forEach(button => {
                        button.addEventListener('click', function() {
                            this.closest('.medicine-reminder').classList.toggle('completed');
                            saveReminders();
                        });
                    });

                    document.querySelectorAll('.reminder-delete').forEach(button => {
                        button.addEventListener('click', function() {
                            if (confirm('Are you sure you want to delete this reminder?')) {
                                const reminderElement = this.closest('.medicine-reminder');
                                remindersList.removeChild(reminderElement);
                                saveReminders();
                            }
                        });
                    });
                }
            }

            // Check for medicine reminders that need to be taken
            function checkReminders() {
                const now = new Date();
                const currentTime = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                document.querySelectorAll('.medicine-reminder:not(.completed)').forEach(reminder => {
                    const reminderTime = reminder.querySelector('.reminder-time').textContent;
                    if (reminderTime === currentTime) {
                        reminder.classList.add('pulse-animation');

                        // Show notification if supported
                        if ('Notification' in window && Notification.permission === 'granted') {
                            const medicineName = reminder.querySelector('h5').textContent;
                            new Notification('Medicine Reminder', {
                                body: `Time to take ${medicineName}!`,
                                icon: 'https://via.placeholder.com/50'
                            });
                        }
                    }
                });
            }

            // Handle frequency selection change
            function handleFrequencyChange() {
                if (this.value === 'custom') {
                    customFrequencyContainer.classList.remove('d-none');
                } else {
                    customFrequencyContainer.classList.add('d-none');
                }
            }

            // Request notification permission
            function requestNotificationPermission() {
                if ('Notification' in window) {
                    Notification.requestPermission();
                }
            }

            // Set up event listeners (with null checks)
            if (sendButton) {
                sendButton.addEventListener('click', sendMessage);
            }
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }

            // Rating functionality
            if (ratingStars.length > 0) {
                ratingStars.forEach(star => {
                    star.addEventListener('click', setRating);
                });
            }

            // Feedback submission
            if (submitFeedback) {
                submitFeedback.addEventListener('click', handleFeedbackSubmission);
            }

            // Dark mode
            if (modeToggle) {
                modeToggle.addEventListener('click', toggleDarkMode);
            }

            // Check saved dark mode preference
            if (localStorage.getItem('darkMode') === 'true' && modeToggle) {
                toggleDarkMode();
            }

            // Medicine reminders
            if (addReminderForm) {
                addReminderForm.addEventListener('submit', addReminder);
            }

            if (frequencySelect) {
                frequencySelect.addEventListener('change', handleFrequencyChange);
            }

            // Load reminders at startup
            if (remindersList) {
                loadReminders();
            }

            // Check for reminders every minute
            setInterval(checkReminders, 60000);

            // Request notification permission
            requestNotificationPermission();

            // Add animation to typing indicator
                        // Add animation to typing indicator
                        const style = document.createElement('style');
            style.textContent = `
                @keyframes typing {
                    0% { opacity: 0.3; }
                    50% { opacity: 1; }
                    100% { opacity: 0.3; }
                }
                .typing-indicator span {
                    animation: typing 1s infinite;
                    display: inline-block;
                }
                .typing-indicator span:nth-child(2) {
                    animation-delay: 0.3s;
                }
                .typing-indicator span:nth-child(3) {
                    animation-delay: 0.6s;
                }
            `;
            document.head.appendChild(style);

            console.log("Health Assistant Chat initialized successfully!");
        });
    </script>
</body>
</html>